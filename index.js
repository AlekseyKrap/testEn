(()=>{let t={HTTP_ERROR:4};function e(t){let e,r=!1;return(...o)=>(r||(r=!0,e=t(...o)),e)}class r{constructor(t){this.isRequesting=!1,this.isResponsedWithError=!1,this.abort=()=>{};let{publisherTagUrl:e,timeout:r,data:o,callbacks:s,method:n="POST"}=t;this.publisherTagUrl=e,this.timeout=r,this.data=o?JSON.stringify(o):null,this.method=n,this.callbacks={onResponse:s.onResponse,onError:s.onError,onTimeout:s.onTimeout}}sendXhr(){this.isRequesting=!0,this.isResponsedWithError=!1,function t(r){let o;let{method:s="GET",url:n,async:i=!0,data:a,responseType:l="text",onBeforeSend:u=()=>{},onRetry:c=()=>!0,checkStatus:d=t=>200===t,headers:h={},xhrConstructor:m=XMLHttpRequest,retries:p=0,timeout:f=0,withCredentials:b=!1,onAbort:g,onSetup:R,onSuccess:y=()=>{},onError:E=()=>{}}=r;if(!m)return;let w=!1,T=0,q=e(y),x=e(E),S=e=>{if(I.onerror&&(I.onerror=null),I.onreadystatechange&&(I.onreadystatechange=null),T&&clearTimeout(T),T&&4!==I.readyState||w)try{I.abort()}catch(t){}if(!w){if(p>0){let s=c(e,I);if("boolean"!=typeof s||s){if(w)return;t({...r,onSetup:t=>{let e=t.abort;w&&e(o)},retries:p-1});return}}x(e,I)}},I=new m;try{I.open(s,n,i)}catch(t){S(t);return}if(I.responseType=l,I.withCredentials=b,Object.entries(h).forEach(([t,e])=>{try{I.setRequestHeader(t,e)}catch(t){}}),f>0&&isFinite(f)&&(T=window.setTimeout(()=>{S(Error(`Request timeout, ${n}`))},f)),I.onerror=()=>S(Error("Network error")),I.onreadystatechange=function(){if(4===I.readyState){let t=I.status;d(t)?(clearTimeout(T),q(I)):S(Error(`Invalid request status ${t}, ${n}`))}},("function"!=typeof R||(R({abort:t=>{w=!0,o=t,S(Error("Abort request")),"function"==typeof g&&g(t)}}),!w))&&(u(I,r),!w))try{I.send(a)}catch(t){S(t)}}({url:this.publisherTagUrl,method:this.method,data:this.data,withCredentials:!0,headers:{"Content-Type":"text/plain"},timeout:this.timeout,onSetup:t=>{this.abort=t.abort},onSuccess:t=>{this.onResponse(t.response)},onError:(e,r)=>{e instanceof Error?0===e.message.indexOf("Request timeout")?this.onTimeout():this.onError(e.message,t.HTTP_ERROR):r&&this.onError(r.statusText,t.HTTP_ERROR)}})}abortRequest(t){this.abort(t)}onResponse(t){this.isRequesting&&(this.isRequesting=!1,this.callbacks.onResponse(t))}onError(t,e){this.isResponsedWithError=!0,this.isRequesting&&(this.isRequesting=!1,this.callbacks.onError(t,e))}onTimeout(){this.isRequesting&&!this.isResponsedWithError&&(this.isRequesting=!1,this.callbacks.onTimeout())}}class o extends r{sendRequest(){return new Promise((t,e)=>{this.callbacks={onResponse:t,onError:(t,r)=>{e(Error(`HTTP Error ${r}: ${t}`))},onTimeout:()=>{e(Error("Request timeout"))}},this.sendXhr()})}}let s="adsbyxoalt",n="xoalt-data-id",i="xoalt_local_id";function a(){let t=new Uint8Array(8);return crypto.getRandomValues(t),Array.from(t,t=>t.toString(16).padStart(2,"0")).join("")}function l(t){if(t.innerHTML.trim().length>0)return null;let e=t.getAttribute(n);e||(e=a(),t.setAttribute(n,e));let r=window.getComputedStyle(t),o=parseInt(r.width)||0,s=parseInt(r.height)||0,i=t.getAttribute("xoalt-data-spot");return i?{id:e,element:t,width:o,height:s,placementId:i}:(console.warn(`Element with ID ${e} does not have a placement ID.`),null)}async function u(){try{let t=await fetch("https://sync.bumlam.com/?src=etg1",{credentials:"include",mode:"cors"}),e=await t.text(),r="string"==typeof e?e.substring(e.lastIndexOf("= '")+3,e.lastIndexOf("';")):void 0;return r?.includes("#")?r.split("#")[0]:r}catch(t){return}}async function c(t){let e=new o({publisherTagUrl:"https://hb.xoalt.com/x-simb-web/",timeout:5e3,data:t,method:"POST",callbacks:{onResponse:t=>t,onError:t=>t,onTimeout:()=>(console.warn("Request timed out."),{bids:[]})}});try{let t=await e.sendRequest(),r=JSON.parse(t);return await r}catch(t){if(t instanceof Error&&"AbortError"===t.name)return console.warn("Request timed out or aborted."),{bids:[]};throw t}}function d({blocks:t,localId:e,uid3:r}){return{id:a(),imp:t.map(t=>({id:t.id,banner:{format:[{w:t.width,h:t.height}]},ext:{placementid:t.placementId}})),site:{page:window.location.href},device:{ua:navigator.userAgent},user:{eids:r?[]:[{source:"1stcookie",uids:[e]}],id:r}}}function h(t,e){if(!t.bids||!Array.isArray(t.bids))return;let r=new Map(e.map(t=>[t.id,t]));t.bids.forEach(t=>{let e=r.get(t.id);if(!e||1!==t.mtype)return;let o=document.createElement("iframe");o.width=t.size.width+"px",o.height=t.size.height+"px",o.src="data:text/html;charset=utf-8,"+encodeURI(t.adm),o.style.border="0",e.element.appendChild(o),e.element.setAttribute("xoalt-data-status","filled")})}!async function(){let t;let e=await u(),r=function(){let t=document.querySelectorAll(`.${s}`),e=[];return t.forEach(t=>{let r=l(t);r&&e.push(r)}),e}(),o=((t=localStorage.getItem(i))||(t=a(),localStorage.setItem(i,t)),t);if(new MutationObserver(async t=>{let r=[];if(console.log("MutationObserver triggered"),t.forEach(t=>{t.addedNodes.forEach(t=>{t instanceof HTMLElement&&(t.classList.contains(s)||t.querySelector(`.${s}`))&&r.push(t)})}),!r.length)return;let n=[];if(r.forEach(t=>{let e=l(t);e&&n.push(e)}),0===n.length)return;let i=d({blocks:n,localId:o,uid3:e});h(await c(i),n)}).observe(document.body,{childList:!0,subtree:!0}),0===r.length){console.warn("No unfilled ad blocks found.");return}let n=d({blocks:r,localId:o,uid3:e});h(await c(n),r)}()})();